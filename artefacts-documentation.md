# Simulation Artefacts Documentation

This document outlines the various output files generated by the simulation runs, detailing their purpose, content, and the scripts responsible for their creation.

## Overview of Simulation Process

The simulation process is orchestrated primarily by `run_debug.py` (or `run.py` for production runs). This script initiates the core simulation logic found in `sim/formation/triangle.py`, which calculates satellite trajectories, analyzes formation geometry, and performs various engineering assessments. The raw data and initial summary files are generated by `sim/formation/triangle.py`.

Subsequently, `tools/render_debug_plots.py` processes the generated CSV data to produce a variety of visualizations, including time-series plots and ground track maps. Finally, `tools/generate_triangle_report.py` creates more in-depth analytical plots and reports, such as sensitivity analyses and performance metrics.

## Generated Artefacts

The following files are typically found in a timestamped debug run directory (e.g., `artefacts/debug/YYYYMMDDTHHMMSSZ`):

### CSV Files (Generated by `sim/formation/triangle.py` via `run_debug.py`)

*   **`positions_m.csv`**
    *   **Generating Script**: `sim/formation/triangle.py` (called by `run_debug.py`)
    *   **Purpose**: Records the inertial positions of each satellite over time.
    *   **Content**: Time (UTC) and X, Y, Z coordinates in meters for each satellite.

*   **`velocities_mps.csv`**
    *   **Generating Script**: `sim/formation/triangle.py` (called by `run_debug.py`)
    *   **Purpose**: Records the inertial velocities of each satellite over time.
    *   **Content**: Time (UTC) and Vx, Vy, Vz components of velocity in meters per second for each satellite.

*   **`latitudes_rad.csv`**
    *   **Generating Script**: `sim/formation/triangle.py` (called by `run_debug.py`)
    *   **Purpose**: Records the geodetic latitudes of each satellite over time.
    *   **Content**: Time (UTC) and latitude in radians for each satellite.

*   **`longitudes_rad.csv`**
    *   **Generating Script**: `sim/formation/triangle.py` (called by `run_debug.py`)
    *   **Purpose**: Records the geodetic longitudes of each satellite over time.
    *   **Content**: Time (UTC) and longitude in radians for each satellite.

*   **`altitudes_m.csv`**
    *   **Generating Script**: `sim/formation/triangle.py` (called by `run_debug.py`)
    *   **Purpose**: Records the geodetic altitudes of each satellite over time.
    *   **Content**: Time (UTC) and altitude in meters for each satellite.

*   **`triangle_geometry.csv`**
    *   **Generating Script**: `sim/formation/triangle.py` (called by `run_debug.py`)
    *   **Purpose**: Provides diagnostic metrics related to the triangular formation's geometry.
    *   **Content**: Time (UTC), triangle area (m²), triangle aspect ratio, and side lengths (m) for the formation.

*   **`ground_ranges.csv`**
    *   **Generating Script**: `sim/formation/triangle.py` (called by `run_debug.py`)
    *   **Purpose**: Records the maximum ground distance to the target and minimum command distance to the ground station.
    *   **Content**: Time (UTC), maximum ground distance (km), and minimum command distance (km).

*   **`orbital_elements.csv`**
    *   **Generating Script**: `sim/formation/triangle.py` (called by `run_debug.py`)
    *   **Purpose**: A consolidated history of the classical orbital elements for all satellites.
    *   **Content**: Time (UTC), satellite ID, semi-major axis (km), eccentricity, inclination (deg), RAAN (deg), argument of perigee (deg), and mean anomaly (deg).

*   **`maintenance_summary.csv`**
    *   **Generating Script**: `sim/formation/triangle.py` (called by `run_debug.py`)
    *   **Purpose**: Summarizes the estimated delta-v required for station-keeping maneuvers.
    *   **Content**: Satellite ID, mean differential acceleration (m/s²), peak differential acceleration (m/s²), delta-v per burn (m/s), and annual delta-v (m/s).

*   **`command_windows.csv`**
    *   **Generating Script**: `sim/formation/triangle.py` (called by `run_debug.py`)
    *   **Purpose**: Lists the time intervals during which the satellites are in contact with the ground station.
    *   **Content**: Window index, start time (UTC), end time (UTC), and duration (s).

*   **`injection_recovery.csv`**
    *   **Generating Script**: `sim/formation/triangle.py` (called by `run_debug.py`)
    *   **Purpose**: Contains the results of a Monte Carlo simulation assessing the delta-v needed to correct for injection errors.
    *   **Content**: Sample ID, satellite ID, position error (m), velocity error (m/s), total delta-v (m/s), and success status.

*   **`drag_dispersion.csv`**
    *   **Generating Script**: `sim/formation/triangle.py` (called by `run_debug.py`)
    *   **Purpose**: Contains the results of a Monte Carlo simulation analyzing the effects of atmospheric drag on orbital elements.
    *   **Content**: Sample ID, density scale, drag coefficient, ballistic coefficient (m²/kg), semi-major axis delta (m), altitude delta (m), along-track shift (km), ground distance delta (km), command distance delta (km), and within tolerance status.

### JSON Files (Generated by `sim/formation/triangle.py` via `run_debug.py`)

*   **`triangle_summary.json`**
    *   **Generating Script**: `sim/formation/triangle.py` (called by `run_debug.py`)
    *   **Purpose**: A comprehensive JSON file containing all the metrics and a summary of the simulation results. This includes detailed geometry data, metrics for triangle formation, ground track, formation window, orbital elements, maintenance, command latency, injection recovery, and drag dispersion.
    *   **Content**: Structured JSON data with various simulation outputs and metrics.

### Plot Files (Generated by `tools/render_debug_plots.py` and `tools/generate_triangle_report.py` in the `plots` subdirectory)

*   **`plots/latitude_timeseries.svg`**
    *   **Generating Script**: `tools/render_debug_plots.py`
    *   **Purpose**: Visualizes the evolution of satellite latitudes over time.
    *   **Content**: SVG plot showing latitude (degrees) vs. Time (UTC) for each satellite.

*   **`plots/longitude_timeseries.svg`**
    *   **Generating Script**: `tools/render_debug_plots.py`
    *   **Purpose**: Visualizes the evolution of satellite longitudes over time.
    *   **Content**: SVG plot showing longitude (degrees) vs. Time (UTC) for each satellite.

*   **`plots/altitude_timeseries.svg`**
    *   **Generating Script**: `tools/render_debug_plots.py`
    *   **Purpose**: Visualizes the evolution of satellite altitudes over time.
    *   **Content**: SVG plot showing altitude (km) vs. Time (UTC) for each satellite, including centroid and design altitude.

*   **`plots/ground_track_tehran_map.svg`**
    *   **Generating Script**: `tools/render_debug_plots.py`
    *   **Purpose**: Displays the ground tracks of the satellites over a map, focusing on the region around Tehran.
    *   **Content**: SVG map showing satellite ground tracks, with Tehran marked.

*   **`plots/ground_command_ranges.svg`**
    *   **Generating Script**: `tools/render_debug_plots.py`
    *   **Purpose**: Visualizes the maximum ground distance to the target and minimum command distance to the ground station over time.
    *   **Content**: SVG plot showing range (km) vs. Time (UTC), with tolerance limits.

*   **`plots/formation_3d.html`**
    *   **Generating Script**: `tools/render_debug_plots.py`
    *   **Purpose**: Provides an interactive three-dimensional visualization of the satellite formation in Earth-centred coordinates.
    *   **Content**: HTML file with an interactive Plotly 3D scene.

*   **`plots/formation_3d.svg`**
    *   **Generating Script**: `tools/render_debug_plots.py`
    *   **Purpose**: Provides a static SVG visualization of the satellite formation in Earth-centred coordinates.
    *   **Content**: SVG plot of the 3D formation.

*   **`plots/orbital_elements_timeseries.svg`**
    *   **Generating Script**: `tools/render_debug_plots.py` and `tools/generate_triangle_report.py`
    *   **Purpose**: Visualizes the time evolution of classical orbital elements for each satellite.
    *   **Content**: SVG plots showing semi-major axis, eccentricity, inclination, RAAN, argument of perigee, and mean anomaly vs. Time (UTC).

*   **`plots/orbital_elements_formation_window.svg`**
    *   **Generating Script**: `tools/render_debug_plots.py`
    *   **Purpose**: Visualizes the classical orbital elements specifically during the defined formation window.
    *   **Content**: SVG plots similar to `orbital_elements_timeseries.svg`, but focused on the formation window.

*   **`plots/triangle_geometry_timeseries.svg`**
    *   **Generating Script**: `tools/render_debug_plots.py`
    *   **Purpose**: Visualizes the evolution of triangle geometry metrics (area, aspect ratio, side lengths) over time.
    *   **Content**: SVG plots showing area (m²), aspect ratio, and side lengths (m) vs. Time (UTC), with tolerance bands.

*   **`plots/ground_tracks.svg`**
    *   **Generating Script**: `tools/generate_triangle_report.py`
    *   **Purpose**: Shows 24-hour ground tracks with the 90-second Tehran window highlighted.
    *   **Content**: SVG plot of ground tracks (latitude vs. longitude).

*   **`plots/ground_tracks_tehran.svg`**
    *   **Generating Script**: `tools/generate_triangle_report.py`
    *   **Purpose**: Provides a zoomed-in view of the ground tracks over Tehran during overflight, including the Tehran boundary.
    *   **Content**: SVG plot of local ground tracks.

*   **`plots/ground_tracks_tehran_animation.html`**
    *   **Generating Script**: `tools/generate_triangle_report.py`
    *   **Purpose**: An animated visualization of the ground tracks over Tehran, showing satellite movement over time.
    *   **Content**: HTML file with an interactive Plotly animation.

*   **`plots/formation_triangle_snapshot.svg`**
    *   **Generating Script**: `tools/generate_triangle_report.py`
    *   **Purpose**: Displays a snapshot of the formation geometry in the Local Vertical Local Horizontal (LVLH) frame at the start of the formation window.
    *   **Content**: SVG plot showing radial vs. along-track positions (km) for each satellite.

*   **`plots/relative_positions.svg`**
    *   **Generating Script**: `tools/generate_triangle_report.py`
    *   **Purpose**: Shows snapshots of relative LVLH positions of satellites during the Tehran access window.
    *   **Content**: SVG plots of along-track vs. radial positions (km) at different time points.

*   **`plots/pairwise_distances.svg`**
    *   **Generating Script**: `tools/generate_triangle_report.py`
    *   **Purpose**: Visualizes the pairwise separation distances between satellites during the access window.
    *   **Content**: SVG plot showing separation (km) vs. Time (UTC).

*   **`plots/access_timeline.svg`**
    *   **Generating Script**: `tools/generate_triangle_report.py`
    *   **Purpose**: Illustrates the daily recurrence of the 90-second access window over a week.
    *   **Content**: SVG plot showing access windows over several days.

*   **`plots/perturbation_effects.svg`**
    *   **Generating Script**: `tools/generate_triangle_report.py`
    *   **Purpose**: Visualizes the effects of various perturbations (J2, drag, SRP) on orbital elements over time.
    *   **Content**: SVG plot showing RAAN drift (deg), altitude change (km), and along-track shift (km) vs. elapsed days.

*   **`plots/maintenance_delta_v.svg`**
    *   **Generating Script**: `tools/generate_triangle_report.py`
    *   **Purpose**: Displays the annual maintenance delta-v budget for each spacecraft.
    *   **Content**: Bar chart showing annual delta-v (m/s) per satellite.

*   **`plots/monte_carlo_sensitivity.svg`**
    *   **Generating Script**: `tools/generate_triangle_report.py`
    *   **Purpose**: Visualizes the distribution of recovery delta-v in a Monte Carlo simulation against initial position errors.
    *   **Content**: Scatter plot showing recovery delta-v (m/s) vs. initial position error (m).

*   **`plots/analytical_vs_stk_groundtrack.svg`**
    *   **Generating Script**: `tools/generate_triangle_report.py`
    *   **Purpose**: Compares the analytically propagated ground tracks with those exported from STK.
    *   **Content**: SVG plot showing analytical and STK ground tracks (latitude vs. longitude).

*   **`plots/performance_metrics.svg`**
    *   **Generating Script**: `tools/generate_triangle_report.py`
    *   **Purpose**: Compares key performance metrics against defined mission thresholds.
    *   **Content**: Bar chart showing measured values vs. requirements for various metrics.

*   **`plots/access_sensitivity_contour.svg`**
    *   **Generating Script**: `tools/generate_triangle_report.py`
    *   **Purpose**: Shows the sensitivity of access duration to changes in orbital parameters (inclination and semi-major axis) using a contour plot.
    *   **Content**: Contour plot showing formation window duration (s) vs. inclination (deg) and semi-major axis (km).

### Directory Artefacts

*   **`orbital_elements/`**
    *   **Generating Script**: `sim/formation/triangle.py` (called by `run_debug.py`)
    *   **Purpose**: Contains individual CSV files for the classical orbital elements of each satellite.
    *   **Content**: A subdirectory with files like `sat1_orbital_elements.csv`, `sat2_orbital_elements.csv`, etc., each containing time (UTC) and orbital elements for a specific satellite.

*   **`stk/`**
    *   **Generating Script**: `sim/formation/triangle.py` (called by `run_debug.py`)
    *   **Purpose**: Contains files exported for use with AGI's Systems Tool Kit (STK) for advanced visualization and analysis. These files typically include ephemeris (`.e`), ground track (`.gt`), facility (`.fac`), and contact (`.int`) files.
    *   **Content**: Various STK-compatible files for scenario reconstruction.
